<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 3 Tests</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mocha/10.2.0/mocha.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mocha/10.2.0/mocha.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chai/4.3.7/chai.js"></script>
</head>
<body>
    <div id="mocha"></div>

    <script type="module">
        
        import * as lab3 from './lab3.js';

        
        mocha.setup('bdd');
        const assert = chai.assert;

        
        describe('getDecimal', function() {
            it('должна возвращать дробную часть положительного числа', function() {
                assert.equal(lab3.getDecimal(1.23), 0.23);
            });
            it('должна возвращать дробную часть отрицательного числа', function() {
                assert.equal(lab3.getDecimal(-1.23), 0.77);
            });
            it('должна возвращать 0 для целого числа', function() {
                assert.equal(lab3.getDecimal(1), 0);
            });
        });

        describe('normalizeUrl', function() {
            it('должна добавлять https:// к URL без протокола', function() {
                assert.equal(lab3.normalizeUrl('yandex.ru'), 'https://yandex.ru');
            });
            it('должна заменять http:// на https://', function() {
                assert.equal(lab3.normalizeUrl('http://yandex.ru'), 'https://yandex.ru');
            });
            it('должна оставлять https:// без изменений', function() {
                assert.equal(lab3.normalizeUrl('https://yandex.ru'), 'https://yandex.ru');
            });
            it('должна корректно обрабатывать URL с https в домене', function() {
                assert.equal(lab3.normalizeUrl('https.ru'), 'https://https.ru');
            });
        });

        describe('checkSpam', function() {
            it('должна находить XXX в любом регистре', function() {
                assert.isTrue(lab3.checkSpam('_XxX_'));
            });
            it('должна находить viagra в любом регистре', function() {
                assert.isTrue(lab3.checkSpam('Viagra'));
            });
            it('должна возвращать false для строк без спама', function() {
                assert.isFalse(lab3.checkSpam('test'));
            });
        });

        describe('truncate', function() {
            it('не должна изменять строку, если она короче maxlength', function() {
                assert.equal(lab3.truncate('Мама мыла раму.', 100), 'Мама мыла раму.');
            });
            it('должна усекать строку и добавлять многоточие', function() {
                assert.equal(lab3.truncate('Мама мыла раму.', 10), 'Мама мыла…');
            });
        });

        describe('camelize', function() {
            it('должна преобразовывать kebab-case в camelCase', function() {
                assert.equal(lab3.camelize('var-test-text'), 'varTestText');
            });
        });

        describe('fibs', function() {
            it('должна возвращать пустой массив для n = 0', function() {
                assert.deepEqual(lab3.fibs(0), []);
            });
            it('должна возвращать [0n] для n = 1', function() {
                assert.deepEqual(lab3.fibs(1), [0n]);
            });
            it('должна возвращать правильную последовательность Фибоначчи', function() {
                assert.deepEqual(lab3.fibs(5), [0n, 1n, 1n, 2n, 3n]);
            });
        });

        describe('arrReverseSorted', function() {
            it('должна возвращать массив, отсортированный по убыванию', function() {
                assert.deepEqual(lab3.arrReverseSorted([1, 3, 22]), [22, 3, 1]);
            });
            it('не должна изменять исходный массив', function() {
                const arr = [1, 3, 22];
                lab3.arrReverseSorted(arr);
                assert.deepEqual(arr, [1, 3, 22]);
            });
        });
describe('unique', function() {
            it('должна возвращать массив уникальных чисел', function() {
                assert.deepEqual(lab3.unique([0, 1, 1, 2]), [0, 1, 2]);
            });
            it('должна возвращать массив уникальных строк', function() {
                assert.deepEqual(lab3.unique(['a', 'b', 'c', 'c']), ['a', 'b', 'c']);
            });
        });

        
        mocha.run();
    </script>
</body>
</html>